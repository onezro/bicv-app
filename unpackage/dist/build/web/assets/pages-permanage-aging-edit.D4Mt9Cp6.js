import{n as e,r as a,ap as t,p as l,q as o,_ as u,v as s,x as n,d,w as i,i as r,o as c,e as p,E as m,y as v,z as f,F as _,a6 as b,aq as y,s as h,a9 as x,am as g}from"./index-BGMMYpLj.js";import{_ as C}from"./u-input.Coqpc1Jd.js";import{_ as S,a as N}from"./u-form.Q5Xs4RHm.js";import{_ as V}from"./uni-data-checkbox.BZqLlmt3.js";import{_ as j}from"./uni-icons.DYEN23k6.js";import{_ as k}from"./uni-section.CCDL9Cq2.js";import{_ as L,a as P}from"./u-row.CNEaJGtR.js";import{_ as w}from"./u-textarea.BjzjcY23.js";import{_ as F}from"./u-cell._nNkUgnH.js";import{_ as D,a as z}from"./uni-swipe-action.DijPpv8B.js";import{_ as U}from"./uni-list.BH0W-wlO.js";import{_ as O}from"./u-button.Dr9wKWVi.js";import{Q,A,a as M,b as T}from"./asy.Dp3pZsVN.js";import{b as W,a as q}from"./prompt.CRqnvq7m.js";import{u as B}from"./user.CJRpAqDR.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./u-icon.B26jy-l1.js";/* empty css                                                               */import"./u-line.CTRc1Fj8.js";import"./uni-cloud.es.BPDmVjNF.js";import"./uni-load-more.BR-FgQCx.js";import"./u-loading-icon.DEWftbaH.js";import"./config.C9WjKJqE.js";const $=I({__name:"edit",setup(I){const $=B(),{name:E}=e($),G=a({SN:"",LocationCode:"",type:0}),H=a([{text:"入库",value:0},{text:"出库",value:1}]),K=a({workStationDec:"",workstationName:"",MfgOrder:"",ProductName:"",ProductDesc:"",Qty:"",type:"",Container:"",userAccount:E.value}),R=a(!0),Y=a(!1),Z=a(0),J=a([{text:"删除",style:{backgroundColor:"#F56C6C"}}]),X=a([]);a([]);const ee=a(!0),ae=a();t((()=>G.value.type),((e,a)=>{0==e?(ee.value=!0,le(),b((()=>{ae.value.resetFields()})),G.value.LocationCode="",X.value=[]):(ee.value=!1,le(),b((()=>{ae.value.resetFields()})),G.value.LocationCode="",X.value=[])})),l((()=>{o().select(".sect").boundingClientRect((e=>{Z.value=e.height-45-5+"px"})).exec()})),u((e=>{K.value.workStationDec=e.workStationDec,K.value.workstationName=e.workStation}));const te=()=>{Y.value=!1,setTimeout((()=>{Y.value=!0}),100)},le=()=>{R.value=!1,setTimeout((()=>{R.value=!0}),100)},oe=()=>{le()},ue=()=>{y()},se=()=>{ee.value?te():(X.value=[],Q(G.value.LocationCode).then((e=>{if(null!=e.content){const a={WorkStation:K.value.workstationName,user:E.value,LocationCode:G.value.LocationCode,AgingOutboundList:[]};a.AgingOutboundList=e.content.AgingPittedList,X.value=e.content.AgingPittedList,A(a).then((e=>{e.success&&(W(),h({title:e.msg,icon:"success",duration:2500})),G.value.LocationCode="",le()})).catch((e=>{q(),G.value.LocationCode="",le()}))}else q(),G.value.LocationCode="",le(),h({title:"位置上已没有成品",icon:"none",duration:2500})})).catch((()=>{q(),G.value.LocationCode="",le(),h({title:"位置上已没有成品",icon:"none",duration:2500})})))},ne=()=>{x({onlyFromCamera:!0,scanType:["qrCode","barCode","datamatrix","pdf417"],success:e=>{G.value.LocationCode=e.result}})},de=()=>{x({onlyFromCamera:!0,scanType:["qrCode","barCode","datamatrix","pdf417"],success:e=>{G.value.SN=e.result}})},ie=()=>{ae.value.resetFields(),X.value.length<3?M(G.value.SN).then((e=>{if(e.success){-1==X.value.findIndex((e=>e.SN==G.value.SN))?(X.value.push({SN:G.value.SN}),K.value.MfgOrder=e.content[0].MfgOrderName,K.value.type=e.content[0].BD_ProductModel,K.value.ProductName=e.content[0].ProductName,K.value.Qty=e.content[0].Qty,K.value.ProductDesc=e.content[0].ProductDesc,W()):(q(),h({title:"SN重复",icon:"none",duration:2500}))}G.value.SN="",te()})).catch((e=>{q(),G.value.SN="",te()})):(q(),G.value.SN="",te(),h({title:"位置上限",icon:"none",duration:2500}))},re=()=>{const e={WorkStation:K.value.workstationName,user:E.value,LocationBarCode:G.value.LocationCode,AgingPittedList:[...X.value]};T(e).then((e=>{e.success&&(h({title:"入库成功",icon:"success",duration:2500}),ae.value.resetFields(),X.value=[],G.value.LocationCode="",W(),le(),y())})).catch((()=>{q()}))};return(e,a)=>{const t=s(n("up-input"),C),l=s(n("up-form-item"),S),o=s(n("uni-data-checkbox"),V),u=s(n("uni-icons"),j),b=s(n("up-form"),N),y=r,h=s(n("uni-section"),k),x=s(n("up-col"),L),Q=s(n("up-row"),P),A=s(n("up-textarea"),w),M=s(n("up-cell"),F),T=s(n("uni-swipe-action-item"),D),W=s(n("uni-swipe-action"),z),q=s(n("uni-list"),U),B=g,I=s(n("up-button"),O);return c(),d(y,{class:"content"},{default:i((()=>[p(h,{title:"扫描",type:"line"},{default:i((()=>[p(y,{class:"box"},{default:i((()=>[p(b,{ref_key:"baseForm",ref:ae,model:G.value,borderBottom:!0,labelWidth:"65"},{default:i((()=>[p(l,{label:"工位",class:"test"},{default:i((()=>[p(t,{style:{height:"30px"},fontSize:"13px",border:"surround",modelValue:K.value.workStationDec,"onUpdate:modelValue":a[0]||(a[0]=e=>K.value.workStationDec=e),disabled:""},null,8,["modelValue"])])),_:1}),p(l,{label:"操作类型",class:"test"},{default:i((()=>[p(o,{modelValue:G.value.type,"onUpdate:modelValue":a[1]||(a[1]=e=>G.value.type=e),localdata:H.value},null,8,["modelValue","localdata"])])),_:1}),p(l,{label:"位置条码",class:"test"},{default:i((()=>[p(t,{style:{height:"30px"},adjustPosition:"",fontSize:"13px",border:"surround",modelValue:G.value.LocationCode,"onUpdate:modelValue":a[2]||(a[2]=e=>G.value.LocationCode=e),onConfirm:se,clearable:"",focus:R.value,onFocus:ue,onClear:oe},{suffix:i((()=>[p(u,{type:"scan",color:"#bdbdbd",onClick:ne,size:"20"})])),_:1},8,["modelValue","focus"])])),_:1}),p(l,{label:"SN条码",class:"test"},{default:i((()=>[p(t,{style:{height:"30px"},disabled:!ee.value,adjustPosition:!0,fontSize:"13px",border:"surround",modelValue:G.value.SN,"onUpdate:modelValue":a[3]||(a[3]=e=>G.value.SN=e),onConfirm:ie,focus:Y.value,onFocus:ue},{suffix:i((()=>[p(u,{type:"scan",color:"#bdbdbd",onClick:de,size:"20"})])),_:1},8,["disabled","modelValue","focus"])])),_:1})])),_:1},8,["model"])])),_:1})])),_:1}),p(h,{title:"基本信息",type:"line"},{default:i((()=>[p(y,{class:"box"},{default:i((()=>[p(b,{ref_key:"baseForm",ref:ae,model:K.value,borderBottom:!0,labelWidth:"65"},{default:i((()=>[p(Q,{gutter:"20"},{default:i((()=>[p(x,{span:"7"},{default:i((()=>[p(l,{label:"工单",class:"test",prop:"MfgOrder"},{default:i((()=>[p(t,{style:{height:"30px"},fontSize:"13px",border:"surround",modelValue:K.value.MfgOrder,"onUpdate:modelValue":a[4]||(a[4]=e=>K.value.MfgOrder=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1}),p(x,{span:"5"},{default:i((()=>[p(l,{label:"机型",class:"test",prop:"type"},{default:i((()=>[p(y,{style:{width:"90px"}},{default:i((()=>[p(t,{style:{height:"30px"},fontSize:"13px",border:"surround",modelValue:K.value.type,"onUpdate:modelValue":a[5]||(a[5]=e=>K.value.type=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),p(Q,{gutter:"20"},{default:i((()=>[p(x,{span:"7"},{default:i((()=>[p(l,{label:"产品编码",class:"test",prop:"ProductName"},{default:i((()=>[p(t,{style:{height:"30px"},fontSize:"13px",border:"surround",modelValue:K.value.ProductName,"onUpdate:modelValue":a[6]||(a[6]=e=>K.value.ProductName=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1}),p(x,{span:"5"},{default:i((()=>[p(l,{label:"数量",class:"test",prop:"Qty"},{default:i((()=>[p(y,{style:{width:"90px"}},{default:i((()=>[p(t,{style:{height:"30px"},fontSize:"13px",border:"surround",modelValue:K.value.Qty,"onUpdate:modelValue":a[7]||(a[7]=e=>K.value.Qty=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),p(l,{label:"产品描述",class:"test",prop:"ProductDesc"},{default:i((()=>[p(A,{height:"30px",class:"texta",modelValue:K.value.ProductDesc,"onUpdate:modelValue":a[8]||(a[8]=e=>K.value.ProductDesc=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1})])),_:1}),p(h,{title:"明细",type:"line",class:"sect",style:{flex:"1"}},{right:i((()=>[p(I,{class:"custom-style",type:"primary",disabled:!ee.value||0==X.value.length,text:"提交",onClick:re},null,8,["disabled"])])),default:i((()=>[p(B,{"scroll-y":"true",style:m({height:Z.value})},{default:i((()=>[p(q,null,{default:i((()=>[p(W,null,{default:i((()=>[(c(!0),v(_,null,f(X.value,((e,a)=>(c(),d(T,{key:e,"right-options":J.value,onClick:a=>{return t=e.SN,X.value=X.value.filter((e=>e.SN!=t)),void ae.value.resetFields();var t}},{default:i((()=>[p(M,{title:`成品SN：${e.SN}`,value:`序号：${a+1}`},null,8,["title","value"])])),_:2},1032,["right-options","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["style"])])),_:1})])),_:1})}}},[["__scopeId","data-v-5d2a6e6d"]]);export{$ as default};
