import{n as e,r as a,p as t,q as l,_ as o,v as s,x as i,d as n,w as u,i as r,o as d,e as m,E as c,y as p,z as f,F as v,aq as _,a9 as y,bd as C,s as b,am as h}from"./index-BGMMYpLj.js";import{_ as x}from"./u-input.Coqpc1Jd.js";import{_ as g,a as j}from"./u-form.Q5Xs4RHm.js";import{_ as k}from"./uni-icons.DYEN23k6.js";import{_ as w}from"./uni-section.CCDL9Cq2.js";import{_ as N,a as V}from"./u-row.CNEaJGtR.js";import{_ as S}from"./uni-list-item.SqYlFseI.js";import{_ as F,a as Q}from"./uni-swipe-action.DijPpv8B.js";import{_ as D}from"./uni-list.BH0W-wlO.js";import{_ as z}from"./u-button.Dr9wKWVi.js";import{P as I,c as T}from"./asy.Dp3pZsVN.js";import{b as U,a as W}from"./prompt.CRqnvq7m.js";import{u as P}from"./user.CJRpAqDR.js";import{_ as q}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./u-icon.B26jy-l1.js";/* empty css                                                               */import"./u-line.CTRc1Fj8.js";import"./u-loading-icon.DEWftbaH.js";import"./config.C9WjKJqE.js";const B=q({__name:"edit",setup(q){const B=P(),{name:R}=e(B),A=a({workStationDec:"",workstationName:"",MfgOrder:"",ProductName:"",ProductDesc:"",Qty:"",type:"",Container:"",userAccount:R}),E=a(!0),G=a(0),H=a({ContainerName:"",Capacity:"",Quantity:"",Date:"",Inspector:R.value}),K=a(),L=a([]);a(!1),a([]);const M=a([{text:"删除",style:{backgroundColor:"#F56C6C"}}]),O=()=>{E.value=!1,setTimeout((()=>{E.value=!0}),100)},Y=()=>{_()};t((()=>{l().select(".sect").boundingClientRect((e=>{G.value=e.height-45-10+"px"})).exec()})),o((e=>{A.value.workStationDec=e.workStationDec,A.value.workstationName=e.workStation}));const Z=()=>{y({onlyFromCamera:!0,scanType:["qrCode","barCode","datamatrix","pdf417"],success:e=>{J()}})},J=()=>{const e={WorkStation:A.value.workstationName,CarrierName:A.value.Container};-1==L.value.findIndex((e=>e.ContainerName==A.value.Container))?I(e).then((e=>{console.log(e.content),K.value.resetFields(),A.value.Container="",e.success&&(U(),H.value.Capacity=e.content.Capacity,H.value.ContainerName=e.content.CarrierName,H.value.Quantity=e.content.CurrentCapacity,H.value.Inspector=B.name,H.value.Date=C(),L.value.push({...H.value}),console.log(L.value)),O()})).catch((()=>{K.value.resetFields(),A.value.Container="",O(),W()})):(A.value.Container="",O(),W(),b({title:"箱条码重复",icon:"none"}))},X=()=>{let e={WorkStation:A.value.workstationName,item:[...L.value]};T(e).then((e=>{e.success&&(K.value.resetFields(),L.value=[],U(),b({title:e.msg,icon:"success"}),O())})).catch((()=>{K.value.resetFields(),A.value.Container="",O(),W()}))};return(e,a)=>{const t=s(i("up-input"),x),l=s(i("up-form-item"),g),o=s(i("uni-icons"),k),_=s(i("up-form"),j),y=r,C=s(i("uni-section"),w),b=s(i("up-col"),N),I=s(i("up-row"),V),T=s(i("uni-list-item"),S),U=s(i("uni-swipe-action-item"),F),W=s(i("uni-swipe-action"),Q),P=s(i("uni-list"),D),q=h,B=s(i("up-button"),z);return d(),n(y,{class:"content"},{default:u((()=>[m(C,{title:"基本信息",type:"line"},{default:u((()=>[m(y,{class:"box"},{default:u((()=>[m(_,{ref:"baseForm",model:A.value,borderBottom:!0,labelWidth:"65"},{default:u((()=>[m(l,{label:"工位",class:"test"},{default:u((()=>[m(t,{style:{height:"30px"},fontSize:"13px",border:"surround",modelValue:A.value.workStationDec,"onUpdate:modelValue":a[0]||(a[0]=e=>A.value.workStationDec=e),disabled:""},null,8,["modelValue"])])),_:1}),m(l,{label:"扫描条码",class:"test"},{default:u((()=>[m(t,{style:{height:"30px"},adjustPosition:!0,fontSize:"13px",border:"surround",modelValue:A.value.Container,"onUpdate:modelValue":a[1]||(a[1]=e=>A.value.Container=e),onConfirm:J,focus:E.value,onFocus:Y},{suffix:u((()=>[m(o,{type:"scan",color:"#bdbdbd",onClick:Z,size:"20"})])),_:1},8,["modelValue","focus"])])),_:1})])),_:1},8,["model"])])),_:1})])),_:1}),m(C,{title:"箱体信息",type:"line"},{default:u((()=>[m(y,{class:"box"},{default:u((()=>[m(_,{ref_key:"boxFormRef",ref:K,model:H.value,borderBottom:!0,labelWidth:"80"},{default:u((()=>[m(l,{label:"周转箱条码",class:"test",prop:"ContainerName"},{default:u((()=>[m(t,{style:{height:"30px"},fontSize:"13px",border:"surround",modelValue:H.value.ContainerName,"onUpdate:modelValue":a[2]||(a[2]=e=>H.value.ContainerName=e),disabled:""},null,8,["modelValue"])])),_:1}),m(I,{gutter:"20"},{default:u((()=>[m(b,{span:"6"},{default:u((()=>[m(l,{label:"箱容量",class:"test",prop:"Capacity"},{default:u((()=>[m(t,{style:{height:"30px"},fontSize:"13px",border:"surround",modelValue:H.value.Capacity,"onUpdate:modelValue":a[3]||(a[3]=e=>H.value.Capacity=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1}),m(b,{span:"6"},{default:u((()=>[m(l,{label:"已装箱数",class:"test",prop:"Quantity"},{default:u((()=>[m(y,{style:{width:"90px"}},{default:u((()=>[m(t,{style:{height:"30px"},fontSize:"13px",border:"surround",modelValue:H.value.Quantity,"onUpdate:modelValue":a[4]||(a[4]=e=>H.value.Quantity=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1})])),_:1}),m(C,{title:"送检明细",type:"line",class:"sect",style:{flex:"1"}},{right:u((()=>[m(B,{class:"custom-style",type:"primary",disabled:0==L.value.length,text:"送检提交",onClick:X},null,8,["disabled"])])),default:u((()=>[m(q,{"scroll-y":"true",style:c({height:G.value})},{default:u((()=>[m(P,null,{default:u((()=>[m(W,null,{default:u((()=>[(d(!0),p(v,null,f(L.value,((e,a)=>(d(),n(U,{key:e.ContainerName,"right-options":M.value,onClick:a=>{return t=e.ContainerName,L.value=L.value.filter((e=>e.ContainerName!=t)),void K.value.resetFields();var t},disabled:0==e.Qty},{default:u((()=>[m(T,{title:"箱条码："+e.ContainerName,rightText:"箱数量："+e.Quantity},null,8,["title","rightText"])])),_:2},1032,["right-options","onClick","disabled"])))),128))])),_:1})])),_:1})])),_:1},8,["style"])])),_:1})])),_:1})}}},[["__scopeId","data-v-53f62ac6"]]);export{B as default};
