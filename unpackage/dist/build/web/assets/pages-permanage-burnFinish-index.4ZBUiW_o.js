import{n as e,r as t,p as a,q as l,v as o,x as r,d as s,w as u,i,o as n,e as d,E as m,y as c,z as p,F as f,aq as v,s as b,a9 as _,am as C}from"./index-BGMMYpLj.js";import{_ as x}from"./u-input.Coqpc1Jd.js";import{_ as h,a as y}from"./u-form.Q5Xs4RHm.js";import{_ as j}from"./uni-icons.DYEN23k6.js";import{_ as g}from"./uni-section.CCDL9Cq2.js";import{_ as N}from"./uni-list-item.SqYlFseI.js";import{_ as O,a as k}from"./uni-swipe-action.DijPpv8B.js";import{_ as P}from"./uni-list.BH0W-wlO.js";import{_ as R}from"./u-button.Dr9wKWVi.js";import{e as E,f as S}from"./index.C_bR71-q.js";import{b as V,a as w}from"./prompt.CRqnvq7m.js";import{u as D}from"./user.CJRpAqDR.js";import{_ as T}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./u-icon.B26jy-l1.js";/* empty css                                                               */import"./u-line.CTRc1Fj8.js";import"./u-loading-icon.DEWftbaH.js";import"./config.C9WjKJqE.js";const z=T({__name:"index",setup(T){const z=D(),{name:F}=e(z),q=t({OrderNumber:"",ERPOrder:"",barCode:"",StockDetail:[],workstationName:"",workstationDec:"",userAccount:F,txnDate:""}),I=t(!0),M=t(!0),Q=t(0),U=t([]),W=t([{text:"删除",style:{backgroundColor:"#F56C6C"}}]);a((()=>{l().select(".sect").boundingClientRect((e=>{Q.value=e.height-85+"px"})).exec()}));const A=()=>{M.value=!1,setTimeout((()=>{M.value=!0}),100)},G=()=>{v()},H=()=>{E(q.value.barCode).then((e=>{if(""==q.value.OrderNumber)q.value.OrderNumber=e.content[0].MfgOrderName,q.value.ERPOrder=e.content[0].ERPOrder,U.value.push({...e.content[0]}),V(),A();else{let t=U.value.findIndex((e=>e.ContainerName==q.value.barCode));q.value.OrderNumber==e.content[0].MfgOrderName&&-1==t?(U.value.push({...e.content[0]}),V(),A()):(b({title:-1!==t?"入库烧录条码重复!!!":"入库计划号不同",icon:"none",duration:2500}),w(),A())}q.value.barCode=""})).catch((()=>{q.value.barCode="",w(),A()}))},K=()=>{U.value=[],q.value.StockDetail=[],q.value.OrderNumber="",q.value.ERPOrder="",A()},L=()=>{q.value.StockDetail=[...U.value],S(q.value).then((e=>{V(),b({title:"入库成功",icon:"success"}),U.value=[],q.value.StockDetail=[],q.value.OrderNumber="",q.value.ERPOrder="",A()})).catch((e=>{w()}))},Y=()=>{I.value||_({onlyFromCamera:!0,scanType:["qrCode","barCode","datamatrix","pdf417"],success:e=>{q.value.barCode=e.result,H()}})};return(e,t)=>{const a=o(r("up-input"),x),l=o(r("up-form-item"),h),v=o(r("uni-icons"),j),b=o(r("up-form"),y),_=i,E=o(r("uni-section"),g),S=o(r("uni-list-item"),N),V=o(r("uni-swipe-action-item"),O),w=o(r("uni-swipe-action"),k),D=o(r("uni-list"),P),T=C,z=o(r("up-button"),R);return n(),s(_,{class:"content"},{default:u((()=>[d(E,{title:"入库",type:"line"},{default:u((()=>[d(_,{class:"box"},{default:u((()=>[d(b,{labelPosition:"left",model:q.value,ref:"formRef",labelWidth:"65"},{default:u((()=>[d(l,{label:"计划号",prop:"orderNum",class:"test"},{default:u((()=>[d(a,{style:{height:"30px"},fontSize:"13px",disabled:!0,modelValue:q.value.OrderNumber,"onUpdate:modelValue":t[0]||(t[0]=e=>q.value.OrderNumber=e)},null,8,["modelValue"])])),_:1}),d(l,{label:"烧录条码",prop:"barCode",class:"test"},{default:u((()=>[d(a,{placeholder:"烧录条码",adjustPosition:!0,style:{height:"30px"},fontSize:"13px",focus:M.value,modelValue:q.value.barCode,"onUpdate:modelValue":t[1]||(t[1]=e=>q.value.barCode=e),onFocus:G,onConfirm:H},{suffix:u((()=>[d(v,{type:"scan",color:"#bdbdbd",onClick:Y,size:"20"})])),_:1},8,["focus","modelValue"])])),_:1})])),_:1},8,["model"])])),_:1})])),_:1}),d(E,{title:"入库列表",type:"line",class:"sect",style:{flex:"1"}},{default:u((()=>[d(T,{"scroll-y":"true",style:m({height:Q.value})},{default:u((()=>[d(D,null,{default:u((()=>[d(w,null,{default:u((()=>[(n(!0),c(f,null,p(U.value,(e=>(n(),s(V,{key:e,"right-options":W.value,onClick:t=>{return a=e,U.value=U.value.filter((e=>e.ContainerName!=a.ContainerName)),void(0==U.value.length&&(q.value.OrderNumber="",q.value.ERPOrder="",A()));var a}},{default:u((()=>[d(S,{title:"烧录条码:"+e.ContainerName,note:"工单:"+e.ERPOrder+"\n产品编码:"+e.ProductName,rightText:"数量:"+e.Qty},null,8,["title","note","rightText"])])),_:2},1032,["right-options","onClick"])))),128))])),_:1})])),_:1})])),_:1},8,["style"]),d(_,{class:"button-box"},{default:u((()=>[d(z,{class:"custom-style",text:"重置",onClick:K}),d(z,{class:"custom-style",type:"primary",disabled:0==U.value.length,text:"提交入库",onClick:L},null,8,["disabled"])])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-2659f5ff"]]);export{z as default};
